{% extends "index.html" %}
{% block contenido %}
<div class="container py-4" style="max-width: 720px;">
  <div class="mb-3">
    <h2 class="m-0">Nuevo préstamo</h2>
    <small class="text-muted">Fecha máxima se calcula automáticamente (+7 días)</small>
  </div>

  <form method="post" class="card shadow-sm p-3">
    {% csrf_token %}

    <div class="mb-3">
      <label class="form-label">Libro (stock &gt; 0)</label>
      <select name="libro" class="form-select" required>
        {% for l in libros %}
          <option value="{{ l.id }}">{{ l.titulo }} - {{ l.autor }} | Stock: {{ l.stock }}</option>
        {% empty %}
          <option disabled>No hay libros con stock</option>
        {% endfor %}
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Usuario</label>
      <select name="usuario" class="form-select" required>
        {% for u in usuarios %}
          <option value="{{ u.id }}"> {{ u.username }}{% if u.first_name or u.last_name %} — {{ u.first_name }} {{ u.last_name }}{% endif %}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Fecha del préstamo (editable)</label>
      <input type="date" name="fecha_prestamos" class="form-control" value="{{ fecha }}" required>
    </div>

    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">Crear préstamo</button>
      <a class="btn btn-outline-secondary" href="{% url 'lista_prestamos' %}">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
